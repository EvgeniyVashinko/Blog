@model Article
@inject Blog.Domain.DataManager dataManager;
@inject UserManager<User> userManager

@{
    ViewData["Title"] = "Статья";
}

<section>
    <header class="main">
        <h1>@Model.Title</h1>
    </header>
    @if (Model.ImagePath != null)
    {
        <span class="image left"><img src="~/images/@Model.ImagePath" alt="" /></span>
    }


    @Html.Raw(Model.Text)

    <div class="row">
        <div class="col-9 col-12-medium">
            <ul class="icons">
                <li>
                    <strong>@Model.ArticleLikes.Count()</strong>
                </li>
                <li>
                    <a asp-controller="Blog" asp-action="ArticleLike" asp-route-id="@Model.Id" class="icon fa fa-thumbs-up" aria-hidden="true"></a>
                </li>
            </ul>
        </div>
        <div class="col-3 col-12-medium inner">
                <nav id="menu">
                    <ul>
                        <li>
                            <span class="opener">Пожаловаться</span>
                            <vc:categories-list list="@dataManager.ReportCategories.GetReportCategoriesStringList()" select="false" contr="Article" actn="Report" id="@Model.Id"></vc:categories-list>
                        </li>
                    </ul>
                </nav>
        </div>
    </div>


    <form asp-controller="Blog" asp-action="CreateComment">
        <input type="hidden" asp-for="Id" />
        <div>
            <textarea placeholder="Введите текст комментария" rows="6" name="tarea"></textarea>
        </div>
        <br />
        <div>
            <input type="submit" value="Отправить" class="primary" />
        </div>
    </form>

    <br />
    @if (ViewBag.Comments != null)
    {
        @foreach (Comment comment in ViewBag.Comments)
        {
            var uid = comment.UserId.ToString();
            var username = userManager.FindByIdAsync(uid).Result.UserName;
            <div class="box">
                <a href=""><h4>@username</h4></a>
                <p>@comment.Text</p>
                @*<ul class="icons">
                    <li>
                        <strong> Like amount... </strong>
                    </li>
                    <li>
                        <a href="#" class="icon fa fa-thumbs-up" aria-hidden="true"></a>
                    </li>
                </ul>*@
            </div>
        }
    }
</section>

